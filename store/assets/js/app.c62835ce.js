(function(t){function e(e){for(var a,o,r=e[0],l=e[1],c=e[2],u=0,m=[];u<r.length;u++)o=r[u],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&m.push(i[o][0]),i[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);d&&d(e);while(m.length)m.shift()();return n.push.apply(n,c||[]),s()}function s(){for(var t,e=0;e<n.length;e++){for(var s=n[e],a=!0,r=1;r<s.length;r++){var l=s[r];0!==i[l]&&(a=!1)}a&&(n.splice(e--,1),t=o(o.s=s[0]))}return t}var a={},i={app:0},n=[];function o(e){if(a[e])return a[e].exports;var s=a[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=t,o.c=a,o.d=function(t,e,s){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(s,a,function(e){return t[e]}.bind(null,a));return s},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var d=l;n.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"56d7":function(t,e,s){"use strict";s.r(e);s("e260"),s("e6cf"),s("cca6"),s("a79d");var a=s("2b0e"),i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("div",{staticClass:"mdl-layout mdl-js-layout mdl-layout--fixed-header"},[t._m(0),t._m(1),s("Main"),s("debug")],1),s("dialogs")],1)},n=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("header",{staticClass:"mdl-layout__header"},[s("div",{staticClass:"mdl-layout__header-row"},[s("span",{staticClass:"mdl-layout-title"},[t._v("Drawing and guessing game")]),s("div",{staticClass:"mdl-layout-spacer"}),s("nav",{staticClass:"mdl-navigation mdl-layout--large-screen-only"})])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mdl-layout__drawer"},[s("span",{staticClass:"mdl-layout-title"},[t._v("[DGG]")]),s("nav",{staticClass:"mdl-navigation"},[t._v(" Drawing and guessing game ")])])}],o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("main",{staticClass:"mdl-layout__content"},[s("div",{staticClass:"page-content"},[s("div",{staticClass:"mdl-grid"},[s("div",{staticClass:"demo-card-wide mdl-card mdl-shadow--2dp mdl-cell mdl-cell--12-col"},[s("div",{staticClass:"mdl-card__title"},[s("h3",{staticClass:"mdl-card__title-text"},[s("span",{attrs:{id:"room_marker"}},[t.room?s("b",[t._v("ROOM "+t._s(t.room.toUpperCase()))]):t._e()])])]),s("div",{staticClass:"mdl-card__supporting-text"},[t._v(" Write topic and click start to indicate discussion starts. ")]),s("div",{staticClass:"mdl-card__actions mdl-card--border"}),s("Topic"),s("div",{staticClass:"mdl-grid",staticStyle:{width:"100%"}},[s("Users"),s("Drawer"),s("Chat")],1),s("div",{staticClass:"mdl-card__actions mdl-card--border"},[s("a",{staticClass:"mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect",attrs:{id:"change_name"},on:{click:t.onChangeNameClick}},[t._v(" Change name ")]),s("a",{staticClass:"mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect",attrs:{id:"play_sound"},on:{click:t.playSound}},[t._v(" Play sound ")]),t.voting?s("a",{staticClass:"mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect",attrs:{id:"set_voting"},on:{click:t.setUnVoting}},[t._v(" Not voting ")]):s("a",{staticClass:"mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect",attrs:{id:"set_voting"},on:{click:t.setVoting}},[t._v(" Voting ")]),s("a",{staticClass:"mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect",on:{click:t.startEdit}},[t._v(" Start edit ")]),s("a",{staticClass:"mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect",on:{click:t.stopEdit}},[t._v(" Stop edit ")])]),s("Menu")],1)])])])},r=[],l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mdl-cell mdl-cell--3-col"},[a("table",{staticClass:"mdl-data-table mdl-js-data-table mdl-shadow--2dp mdl-cell mdl-cell--12-col",attrs:{id:"table"}},[t._m(0),t.instance?a("tbody",{attrs:{id:"table_body"}},t._l(t.instance.users,(function(e,i,n){return a("tr",{key:"ind-"+i+"-"+n},[a("td",{staticClass:"width-fixed-50"},[t._v(t._s(n+1))]),a("td",{staticClass:"width-minus-100"},[t._v(t._s(e.name?e.name:"[connecting]"))]),t.su?a("td",{staticClass:"width-fixed-50"},[t._v(" "+t._s(e.vote?e.vote:"n/a")+" ")]):e.voting&&(""!==e.vote||t.isOnline(i))?""===e.vote&&"discuss"===t.discuss?a("td",{staticClass:"width-fixed-50"},[a("img",{staticClass:"wait-throbber",attrs:{src:s("f191"),alt:"waiting"}})]):"discuss"===t.discuss&&t.anyUnvoted?a("td",{staticClass:"width-fixed-50"},[a("span",{staticClass:"material-icons",staticStyle:{color:"gray"}},[t._v("done")])]):a("td",{staticClass:"width-fixed-50"},[t._v(" "+t._s(e.vote?e.vote:"n/a")+" ")]):a("td",{staticClass:"width-fixed-50"},[t._v("n/a")]),e.voting?a("td",{staticClass:"width-fixed-50"},[a("span",{staticClass:"material-icons",staticStyle:{color:"gray"}},[t._v("task_alt")])]):a("td",{staticClass:"width-fixed-50"},[a("span",{staticClass:"material-icons",staticStyle:{color:"gray"}},[t._v("highlight_off")])])])})),0):t._e()])])},c=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th",{staticClass:"width-fixed-50"},[t._v("№")]),s("th",{staticClass:"width-minus-100"},[t._v("Name")]),s("th",{staticClass:"width-fixed-50"},[t._v("Vote")]),s("th",{staticClass:"width-fixed-50"},[t._v("Status")])])])}],d={name:"Users",methods:{isOnline:function(t){return this.$store.state.app.isOnline(t)},kick:function(t){var e=t.target.getAttribute("data-uuid");this.$store.state.app.emit("kick",e)}},computed:{instance:function(){return this.$store.state.app.data},app:function(){return this.$store.state.app},anyUnvoted:function(){return this.$store.state.app.anyUnvoted},discuss:function(){return this.$store.state.app.discuss},average:function(){return this.$store.state.app.result.average},recommended:function(){return this.$store.state.app.result.recommended},su:function(){return this.$store.state.app.isSU()}}},u=d,m=s("2877"),p=Object(m["a"])(u,l,c,!1,null,null,null),h=p.exports,v=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mdl-grid mdl-cell mdl-cell--12-col"},[s("div",{staticClass:"mdl-textfield mdl-js-textfield mdl-textfield--floating-label mdl-cell mdl-cell--11-col"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.topic,expression:"topic"}],staticClass:"mdl-textfield__input",attrs:{type:"text",id:"topic",name:"topic"},domProps:{value:t.topic},on:{blur:t.onBlur,keypress:t.onKeyPress,change:t.onChange,input:function(e){e.target.composing||(t.topic=e.target.value)}}}),s("label",{staticClass:"mdl-textfield__label",attrs:{for:"topic"}},[t._v("Topic...")])]),s("button",{staticClass:"mdl-button mdl-card-pocker-card mdl-shadow--2dp mdl-cell mdl-cell--1-col",attrs:{disabled:!t.validTopic},on:{click:t.onReferenceClick}},[s("span",{staticClass:"material-icons",staticStyle:{"font-size":"32px"}},[t._v("open_in_new")])])])},f=[],g=(s("d3b7"),s("3ca3"),s("ddb0"),s("2b3d"),{name:"Topic",methods:{validUrl:function(t){try{new URL(t)}catch(e){return!1}return!0},onBlur:function(t){this.handleEvent(t)},onKeyPress:function(t){13===t.keyCode&&(this.handleEvent(t),t.target.blur(),t.target.parentNode.classList.remove("is-focused"))},handleEvent:function(t){this.$store.state.app.emit("update",{},{topic:t.target.value})},onChange:function(t){this.handleClasses(t.target,t.target.value)},handleClasses:function(t,e){e?t.parentNode.classList.add("is-dirty"):t.parentNode.classList.remove("is-dirty")},onReferenceClick:function(){var t=this.$store.state.app.topic;if(t&&this.validUrl(t)){var e=window.open(t,"_blank");e.focus()}}},computed:{room:function(){return this.$store.state.app.room},topic:{get:function(){var t=document.getElementById("topic");return t&&this.handleClasses(document.getElementById("topic"),this.$store.state.app.topic),this.$store.state.app.topic},set:function(){}},validTopic:function(){return this.$store.state.app.topic&&this.validUrl(this.$store.state.app.topic)}}}),_=g,b=Object(m["a"])(_,v,f,!1,null,null,null),y=b.exports,w=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mdl-card__menu"},[t.time?s("span",[t._v(t._s(t.time))]):t._e(),"result"===t.discuss||"discuss"===t.discuss&&!t.anyUnvoted?s("button",{staticClass:"mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect",attrs:{id:"discuss"},on:{click:t.onDiscussClick}},[t._v(" Clear data ")]):"discuss"===t.discuss?s("button",{staticClass:"mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect",attrs:{id:"discuss"},on:{click:t.onDiscussClick}},[t._v(" Stop discussion ")]):s("button",{staticClass:"mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect",attrs:{disabled:""===t.topic&&"idle"===t.discuss,id:"discuss"},on:{click:t.onDiscussClick}},[t._v(" Start discussion ")])])},C=[],k={name:"Menu",computed:{time:function(){return this.$store.state.app.timer.time},discuss:function(){return this.$store.state.app.discuss},anyUnvoted:function(){return this.$store.state.app.anyUnvoted},topic:function(){return this.$store.state.app.topic}},methods:{onDiscussClick:function(){"idle"===this.$store.state.app.discuss?(this.$store.state.app.emit("update",{},{discuss:"discuss"}),this.$store.state.app.emit("trigger","sound")):"discuss"===this.$store.state.app.discuss&&this.$store.state.app.anyUnvoted?this.$store.state.app.emit("update",{},{discuss:"result"}):this.$store.state.app.emit("bulk",{vote:""},{discuss:"idle",topic:""})}}},$=k,x=Object(m["a"])($,w,C,!1,null,null,null),O=x.exports,j=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},D=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mdl-cell mdl-cell--5-col",staticStyle:{"min-height":"550px"}},[s("div",{staticClass:"wrapper-element",staticStyle:{height:"100%",padding:"5px"}},[s("div",{attrs:{id:"canvas-editor"}})])])}];window.$(document).ready((function(t){var e=["Pencil","Eraser","Text","Line","ArrowOneSide","ArrowTwoSide","Triangle","Rectangle","Circle","Polygon","Color","ShapeBorder","BrushSize","OpacityOption","LineWidth","StrokeWidth","ShapeContextMenu","OvercanvasPopup","OpenPopupButton","ToggleVisibilityButton","TextLineHeight","TextAlign","TextFontFamily","TextFontSize","TextFontWeight","TextFontStyle","TextDecoration","TextColor","TextBackgroundColor"];window.drawer=new window.DrawerJs.Drawer(null,{plugins:e,pluginsConfig:{Image:{scaleDownLargeImage:!0,maxImageSizeKb:1024},BackgroundImage:{scaleDownLargeImage:!0,maxImageSizeKb:1024,imagePosition:"stretch",acceptedMIMETypes:["image/jpeg","image/png","image/gif"],dynamicRepositionImage:!0,dynamicRepositionImageThrottle:100},Text:{editIconMode:!0,editIconSize:"large"}},defaultImageUrl:"/examples/redactor/images/drawer.jpg",defaultActivePlugin:{name:"Pencil",mode:"lastUsed"},debug:!0,transparentBackground:!0,align:"floating",lineAngleTooltip:{enabled:!0,color:"blue",fontSize:15},exitOnOutsideClick:!1,editOnClick:!1}),t("#canvas-editor").append(window.drawer.getHtml()),window.drawer.onInsert()}));var S={name:"Drawer",methods:{},computed:{}},E=S,U=Object(m["a"])(E,j,D,!1,null,null,null),N=U.exports,P=s("d4ec"),T=s("bee2"),I=function(){function t(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;Object(P["a"])(this,t),this.stopped=!0,this.started=!1,this.callable=e,this.interval=s}return Object(T["a"])(t,[{key:"start",value:function(){var t=this;if(!this.started&&(this.started=!0,this.stopped)){this.stopped=!1;var e=setInterval((function(){t.stopped?clearInterval(e):t.callable()}),this.interval);this.callable()}}},{key:"stop",value:function(){this.stopped=!0,this.started=!1}}]),t}(),L=I,M=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mdl-cell mdl-cell--4-col"},[s("table",{staticClass:"mdl-data-table mdl-js-data-table mdl-shadow--2dp mdl-cell mdl-cell--12-col",attrs:{id:"table"}},[t._m(0),t.instance?s("tbody",{attrs:{id:"table_body"}},t._l(t.instance.users,(function(e,a,i){return s("tr",{key:"ind-"+a+"-"+i},[s("td",{staticClass:"width-fixed-50"},[t._v(t._s(i+1))]),s("td",{staticClass:"width-minus-100"},[t._v(t._s(e.name?e.name:"[connecting]"))])])})),0):t._e()])])},R=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th",{staticClass:"width-fixed-50"},[t._v("№")]),s("th",{staticClass:"width-minus-100"},[t._v("Name")])])])}],A={name:"Chat",methods:{isOnline:function(t){return this.$store.state.app.isOnline(t)},kick:function(t){var e=t.target.getAttribute("data-uuid");this.$store.state.app.emit("kick",e)}},computed:{instance:function(){return this.$store.state.app.data},app:function(){return this.$store.state.app},anyUnvoted:function(){return this.$store.state.app.anyUnvoted},discuss:function(){return this.$store.state.app.discuss},average:function(){return this.$store.state.app.result.average},recommended:function(){return this.$store.state.app.result.recommended},su:function(){return this.$store.state.app.isSU()}}},B=A,K=Object(m["a"])(B,M,R,!1,null,null,null),J=K.exports,F={name:"Main",components:{Users:h,Topic:y,Menu:O,Drawer:N,Chat:J},computed:{room:function(){return this.$store.state.app.room},voting:function(){return this.$store.state.app.voting}},methods:{onChangeNameClick:function(){this.$store.state.dialogs.change.showModal()},playSound:function(){this.$store.state.app.emit("trigger","sound")},setVoting:function(){this.$store.state.app.emit("update",{vote:"",voting:!0})},setUnVoting:function(){this.$store.state.app.emit("update",{vote:"",voting:!1})},startEdit:function(){var t=this;window.drawer.api.startEditing(),this.$store.state.app.emit("update",{},{editingUser:this.$store.state.app.uuid}),window.drawerWorker=new L((function(){var e=window.drawer.api.getCanvasAsImage();t.$store.state.app.emit("update",{},{imageData:e})}),1e3),window.drawerWorker.start()},stopEdit:function(){window.drawer.api.stopEditing(),window.drawerWorker.stop(),this.$store.state.app.emit("update",{},{editingUser:"",imageData:""})}}},V=F,z=Object(m["a"])(V,o,r,!1,null,null,null),W=z.exports,H=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",[s("dialog",{ref:"name",staticClass:"mdl-dialog",attrs:{id:"name_dialog"}},[s("h4",{staticClass:"mdl-dialog__title"},[t._v("Name yourself")]),s("div",{staticClass:"mdl-dialog__content"},[s("p",[t._v("Field is required, cannot match any existing name.")]),s("div",{staticClass:"mdl-textfield mdl-js-textfield mdl-textfield--floating-label"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.userName,expression:"userName"}],staticClass:"mdl-textfield__input",attrs:{type:"text","data-ref":"name",id:"name",name:"name"},domProps:{value:t.userName},on:{blur:t.onBlur,keypress:t.onKeyPress,input:function(e){e.target.composing||(t.userName=e.target.value)}}}),s("label",{staticClass:"mdl-textfield__label",attrs:{for:"name"}},[t._v("Name...")])])])]),s("dialog",{ref:"change",staticClass:"mdl-dialog",attrs:{id:"change_dialog"}},[s("h4",{staticClass:"mdl-dialog__title"},[t._v("Change name")]),s("div",{staticClass:"mdl-dialog__content"},[s("p",[t._v("Field is required, cannot match any existing name, press ESC to cancel.")]),s("div",{staticClass:"mdl-textfield mdl-js-textfield mdl-textfield--floating-label"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.userName,expression:"userName"}],staticClass:"mdl-textfield__input",attrs:{"data-ref":"change",type:"text",id:"name",name:"name"},domProps:{value:t.userName},on:{blur:t.onBlur,keypress:t.onKeyPress,input:function(e){e.target.composing||(t.userName=e.target.value)}}}),s("label",{staticClass:"mdl-textfield__label",attrs:{for:"name"}},[t._v("Name...")])])])]),s("dialog",{ref:"start",staticClass:"mdl-dialog",attrs:{id:"start_dialog"}},[s("h4",{staticClass:"mdl-dialog__title"},[t._v("Starting")]),t._m(0)]),s("dialog",{ref:"error",staticClass:"mdl-dialog",attrs:{id:"error_dialog"}},[s("h4",{staticClass:"mdl-dialog__title"},[t._v("Error")]),t._m(1)])])},Q=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mdl-dialog__content"},[s("p",[t._v(" Please wait for connection. ")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mdl-dialog__content"},[s("p",[t._v(" Something went wrong, try reload page. ")])])}],q=(s("b0c0"),{name:"Dialogs",mounted:function(){this.$store.dispatch("setDialog",{name:"name",element:this.$refs.name}),this.$store.dispatch("setDialog",{name:"error",element:this.$refs.error}),this.$store.dispatch("setDialog",{name:"start",element:this.$refs.start}),this.$store.dispatch("setDialog",{name:"change",element:this.$refs.change}),this.$refs.name.addEventListener("cancel",(function(t){t.preventDefault()}))},methods:{onBlur:function(t){this.handleEvent(t)},onKeyPress:function(t){console.log(t.keyCode),13===t.keyCode&&(this.handleEvent(t),t.target.blur(),t.target.parentNode.classList.remove("is-focused"))},handleEvent:function(t){var e=t.target.value;if(e)if(this.$store.state.app.nameExists(e))t.target.parentNode.classList.add("is-invalid");else{t.target.parentNode.classList.remove("is-invalid");var s=this.$store.state.app.getLocalData();s.name=t.target.value,this.$store.state.app.setLocalData(s),this.$store.state.app.emit("update",this.$store.state.app.buildUser({name:s.name}));var a=t.target.getAttribute("data-ref");this.$refs[a].close()}}},computed:{userName:{get:function(){return this.$store.state.app.userName},set:function(t){}}}}),G=q,X=Object(m["a"])(G,H,Q,!1,null,null,null),Y=X.exports,Z=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.isDebug?s("div",{staticClass:"debug",staticStyle:{"max-height":"300px"}},[s("pre",[t._v(t._s(t.stringifyApp))])]):t._e()},tt=[],et={name:"Debug",computed:{isDebug:function(){return this.$store.state.app.isDebug()},stringifyApp:function(){return JSON.stringify(this.$store.state.app.toJson(),null,2)}}},st=et,at=Object(m["a"])(st,Z,tt,!1,null,null,null),it=at.exports,nt={name:"App",components:{Debug:it,Main:W,Dialogs:Y},mounted:function(){this.$store.state.dialogs.start.showModal(),this.$store.state.app.initRoom(),this.$store.dispatch("initSocket")}},ot=nt,rt=(s("5c0b"),Object(m["a"])(ot,i,n,!1,null,null,null)),lt=rt.exports,ct=s("2f62"),dt=s("a562"),ut=(s("99af"),function(){function t(){Object(P["a"])(this,t),this.sec=0,this.stopped=!0,this.time="",this.started=!1}return Object(T["a"])(t,[{key:"processTime",value:function(){var t=new Date(null);t.setSeconds(this.sec);var e=t.getUTCMinutes(),s=t.getUTCSeconds(),a=t.getUTCHours();e<=9&&(e="0".concat(e)),s<=9&&(s="0".concat(s)),a<=9&&(a="0".concat(a)),this.time="".concat(a,":").concat(e,":").concat(s)}},{key:"start",value:function(){var t=this;if(!this.started&&(this.started=!0,this.stopped)){this.stopped=!1;var e=setInterval((function(){t.stopped?clearInterval(e):(t.sec+=1,t.processTime())}),1e3);this.processTime()}}},{key:"stop",value:function(){this.stopped=!0,this.started=!1}},{key:"clear",value:function(){this.time="",this.sec=0,this.stop()}}]),t}()),mt=ut,pt=(s("159b"),s("07ac"),function(){function t(){Object(P["a"])(this,t),this.clear()}return Object(T["a"])(t,[{key:"clear",value:function(){this.values={},this.average=null,this.recommended=null}},{key:"addResult",value:function(t,e){var s=parseFloat(t);isNaN(s)&&(s=0),this.values[e]=s}},{key:"collectCount",value:function(){var t=0;return Object.values(this.values).forEach((function(e){e>0&&(t+=1)})),t}},{key:"collectSum",value:function(){var t=0;return Object.values(this.values).forEach((function(e){t+=e})),t}},{key:"submit",value:function(){var t=this.collectCount();t&&(this.average=this.collectSum()/t,this.processRecommended())}},{key:"processRecommended",value:function(){for(var t=[.5,1,2,3,5,8,13,20,40,100],e=0,s=0,a=0;a<t.length;a++)if(this.average>t[a])e=t[a];else{if(this.average===t[a]){this.recommended=t[a];break}s=t[a];var i=this.recommended-e,n=s-this.recommended;if(i<n){this.recommended=e;break}if(i>n){this.recommended=s;break}}}},{key:"stringify",value:function(){return JSON.stringify(this)}}]),t}()),ht=pt,vt=s("53ca"),ft=(s("ac1f"),s("466d"),s("b64b"),s("4d63"),s("25f0"),s("5319"),s("ec26")),gt=function(){function t(e,s,a){Object(P["a"])(this,t),this.appKey="poker",this.vote="",this.topic="",this.data=null,this.userName="",this.discuss="idle",this.anyUnvoted=!1,this.timer=e,this.result=s,this.room="",this.socketHandler=a,this.socket=null,this.voting=!0,this.uuid="",this.editingUser="",this.imageData=""}return Object(T["a"])(t,[{key:"initRoom",value:function(){var t=window.location.pathname.match(/\/room\/(.+)/);t&&2===t.length?this.room=t[1]:this.room="global",console.log(this.room)}},{key:"nameExists",value:function(t){var e=!1;return Object.values(this.data.users).forEach((function(s){"object"===Object(vt["a"])(s)&&s.hasOwnProperty("name")&&s.name===t&&(e=!0)})),e}},{key:"isObject",value:function(t){return Object(t)===t}},{key:"buildUser",value:function(t){var e=this.getLocalData().uuid;return t.hasOwnProperty("uuid")||(t.uuid=e),t.hasOwnProperty("name")||(this.data.users.hasOwnProperty(e)?t.name=this.data.users[e].name||"":t.name=""),t.hasOwnProperty("vote")||(this.data.users.hasOwnProperty(e)?t.vote=this.data.users[e].vote||"":t.vote=""),t.hasOwnProperty("voting")||(this.data.users.hasOwnProperty(e)?t.voting=this.data.users[e].voting||!0:t.voting=!0),t}},{key:"isOnline",value:function(t){var e=!1;return Object.values(this.data.sockets).forEach((function(s){s===t&&(e=!0)})),e}},{key:"validateData",value:function(t){var e=this.isObject(t)&&t.hasOwnProperty("sockets")&&t.hasOwnProperty("users")&&t.hasOwnProperty("state");if(e){var s=this.getLocalData().uuid;e=this.isObject(t.users[s])}return e}},{key:"mapData",value:function(t,e){var s=this;if(!this.validateData(t))return console.log("Incoming data is invalid."),void(this.isDebug()&&console.log(JSON.stringify(t)));this.data=t;var a=this.getLocalData().uuid;this.uuid=a;var i=t.users[a];if(!i.hasOwnProperty("name")){var n=this.getLocalData(),o=n.name;if(""!==n.name&&!this.nameExists(o))return void this.emit("update",this.buildUser({name:n.name}));e.state.dialogs.name.hasAttribute("open")||e.state.dialogs.name.showModal()}this.userName=i.name,this.voting=i.voting,this.result.clear();var r=!1;Object.keys(t.users).forEach((function(e){""===t.users[e].vote&&s.isOnline(e)&&t.users[e].voting&&(r=!0),s.result.addResult(t.users[e].vote,e),e===a&&(s.vote=t.users[e].vote,s.userName=t.users[e].name)})),this.anyUnvoted=r,this.discuss=t.state.discuss||"idle",this.topic=t.state.topic||"","discuss"===this.discuss&&this.timer.start(),(!this.anyUnvoted&&"discuss"===this.discuss||"result"===this.discuss)&&(this.timer.stop(),this.result.submit()),"idle"===this.discuss&&(this.timer.clear(),this.result.clear()),this.imageData=t.state.imageData||"",this.editingUser=t.state.editingUser||"",""!==this.editingUser&&this.editingUser!==this.uuid&&window.$(".editable-canvas-not-edited").attr("src",this.imageData)}},{key:"createSocket",value:function(t){this.socket=this.socketHandler.create(this,t)}},{key:"trigger",value:function(t,e,s){if("sound"===t){var a="/ding2.mp3",i=new Audio(a);i.play()}}},{key:"emit",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.socket.emit(t,this.room,e,s,a)}},{key:"getQueryParam",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.href,s=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)"),a=s.exec(e);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null}},{key:"isSU",value:function(){return"me"===this.getQueryParam("su")}},{key:"isDebug",value:function(){return"1"===this.getQueryParam("debug")}},{key:"toJson",value:function(){return{vote:this.vote,topic:this.topic,data:this.data,userName:this.userName,discuss:this.discuss,anyUnVoted:this.anyUnvoted,timer:this.timer,result:this.result,room:this.room,uuid:this.uuid,editingUser:this.editingUser,imageData:this.imageData}}},{key:"getLocalData",value:function(){var t=window.localStorage.getItem(this.appKey);if(!t){var e=Object(ft["a"])();return{uuid:e,name:""}}return JSON.parse(t)}},{key:"setLocalData",value:function(t){window.localStorage.setItem(this.appKey,JSON.stringify(t))}}]),t}(),_t=gt,bt=s("c9df"),yt=s.n(bt),wt=function(){function t(){Object(P["a"])(this,t)}return Object(T["a"])(t,[{key:"create",value:function(t,e){var s=yt()("/"+t.appKey,{transports:["websocket"],upgrade:!1});window.addEventListener("unload",(function(){s&&s.close()})),s.on("connect",(function(){e.state.dialogs.start.close();var a=t.getLocalData();t.setLocalData(a),s.emit("create",t.room,a.uuid)})),s.on("error",(function(){e.state.dialogs.error.showModal()})),s.on("disconnect",(function(){e.state.dialogs.error.showModal()})),s.on("status",(function(s){t.mapData(s,e)})),s.on("trigger",(function(s,a){t.trigger(s,a,e)})),s.on("kick",(function(){s.disconnect()}));var a=function t(){setTimeout((function(){s.emit("liveness"),t()}),3e4)};return a(),s}}]),t}(),Ct=wt,kt={state:{app:new _t(new mt,new ht,new Ct),dialogs:{}},mutations:{},actions:{setDialog:function(t,e){dt["a"].registerDialog(e.element),t.state.dialogs[e.name]=e.element},initSocket:function(t){t.state.app.createSocket(t)}}},$t=kt;a["a"].config.productionTip=!1,a["a"].use(ct["a"]),new a["a"]({store:new ct["a"].Store($t),render:function(t){return t(lt)}}).$mount("#app")},"5c0b":function(t,e,s){"use strict";s("9c0c")},"9c0c":function(t,e,s){},f191:function(t,e,s){t.exports=s.p+"assets/img/waiting.ef8d4e6b.gif"}});
//# sourceMappingURL=app.c62835ce.js.map